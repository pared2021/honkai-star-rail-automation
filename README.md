# 崩坏星穹铁道自动化助手

一个功能完整的游戏自动化桌面应用程序，基于 Python + PyQt6 开发。

## 项目特点

- ✅ **功能完整**：这是一个实际可用的程序，而非演示框架
- 🎮 **游戏自动化**：支持崩坏星穹铁道的自动化操作
- 🖥️ **现代界面**：基于 PyQt6 的现代化桌面界面
- 🔍 **智能识别**：使用 OpenCV 进行游戏界面识别
- 📊 **数据管理**：SQLite 数据库存储任务和配置
- 🛡️ **安全可靠**：内置安全模式和错误处理
- 📝 **详细日志**：完整的操作日志和调试信息

## 系统要求

- Windows 10/11
- Python 3.9+
- 4GB+ RAM
- 1920x1080 分辨率（推荐）

## 快速开始

### 1. 环境准备

```bash
# 克隆项目
git clone <repository-url>
cd xingtie

# 安装依赖
pip install -r requirements.txt
```

### 2. 运行程序

```bash
python main.py
```

### 3. 首次使用

1. 启动程序后，系统会自动创建必要的目录和数据库
2. 在"游戏设置"中配置游戏路径和分辨率
3. 在"自动化配置"中调整自动化参数
4. 准备好后点击"开始自动化"按钮

## 项目结构

```
xingtie/
├── main.py                    # 程序入口
├── requirements.txt           # 依赖包列表
├── requirements-dev.txt       # 开发依赖包
├── README.md                  # 项目说明
├── pyproject.toml            # 项目配置文件
├── pytest.ini               # 测试配置
├── mypy.ini                  # 类型检查配置
├── Makefile                  # 构建脚本
├── version.txt               # 版本信息
├── .github/                  # GitHub配置
│   ├── quality-config.json  # 质量配置
│   └── workflows/            # CI/CD工作流
├── config/                   # 配置文件目录
│   ├── default.ini          # 默认配置
│   ├── automation_config.json
│   ├── game_settings.json
│   ├── monitoring.yml
│   ├── linting/             # 代码检查配置
│   ├── testing/             # 测试配置
│   └── ...
├── scripts/                  # 开发工具脚本
│   ├── quality_gate.py      # 质量门禁检查
│   ├── run_tests.py         # 测试运行器
│   ├── code_quality_check.py
│   ├── duplicate_detector.py
│   ├── validate_architecture.py
│   └── ...
├── src/                      # 源代码目录
│   ├── core/                # 核心模块
│   ├── database/            # 数据库模块
│   ├── ui/                  # 用户界面模块
│   ├── automation/          # 自动化模块
│   ├── services/            # 业务服务
│   ├── repositories/        # 数据访问层
│   ├── models/              # 数据模型
│   ├── utils/               # 工具模块
│   ├── monitoring/          # 监控模块
│   ├── adapters/            # 适配器模块
│   ├── interfaces/          # 接口定义
│   ├── exceptions/          # 异常定义
│   ├── middleware/          # 中间件
│   ├── infrastructure/      # 基础设施
│   ├── application/         # 应用层
│   └── config/              # 配置模块
├── tests/                    # 测试目录
│   ├── unit/                # 单元测试
│   ├── integration/         # 集成测试
│   ├── conftest.py          # 测试配置
│   └── ...
├── assets/                   # 资源文件
│   ├── images/              # 图片资源
│   └── templates/           # 模板图片
├── data/                     # 数据目录
│   ├── app.db               # 应用数据库
│   ├── screenshots/         # 截图目录
│   └── ...
├── logs/                     # 日志目录
├── docs/                     # 文档目录
├── reports/                  # 报告目录
│   ├── coverage/            # 覆盖率报告
│   ├── quality/             # 质量报告
│   └── ...
├── migrations/               # 数据库迁移
├── examples/                 # 示例代码
└── venv/                     # 虚拟环境
```

## 核心功能

### 🎮 游戏自动化

- **智能识别**：基于模板匹配的界面元素识别
- **自动操作**：支持点击、按键、拖拽等操作
- **任务管理**：可创建、暂停、停止自动化任务
- **安全模式**：防止误操作和异常情况

### 🖥️ 用户界面

- **现代设计**：基于 PyQt6 的现代化界面
- **多标签页**：任务管理、游戏设置、自动化配置、执行日志
- **实时状态**：显示当前任务状态和执行进度
- **操作日志**：实时显示操作日志和调试信息

### 📊 数据管理

- **SQLite 数据库**：存储用户配置、任务信息、执行日志
- **配置管理**：支持 INI 和 JSON 格式的配置文件
- **数据备份**：自动备份重要数据
- **统计信息**：提供详细的使用统计

### 🔧 技术架构

- **模块化设计**：清晰的模块分离和接口定义
- **异步处理**：使用多线程处理自动化任务
- **错误处理**：完善的异常处理和恢复机制
- **日志系统**：基于 loguru 的高级日志功能

## 配置说明

### 游戏设置

- **游戏路径**：游戏安装目录
- **分辨率**：游戏运行分辨率
- **窗口检测**：自动检测游戏窗口

### 自动化配置

- **操作延迟**：操作间隔时间
- **检测阈值**：模板匹配阈值
- **重试次数**：操作失败重试次数
- **安全选项**：随机延迟、安全模式等

### 高级设置

- **调试模式**：启用详细调试信息
- **性能优化**：内存和CPU使用限制
- **网络设置**：超时和重试配置

## 开发指南

### 开发环境设置

```bash
# 安装开发依赖
pip install -r requirements-dev.txt

# 运行代码质量检查
python scripts/quality_gate.py

# 运行测试
python scripts/run_tests.py

# 检查代码覆盖率
pytest --cov=src --cov-report=html
```

### 添加新功能

1. **创建模块**：在相应目录下创建新的 Python 文件
2. **实现接口**：遵循现有的接口规范
3. **添加测试**：编写单元测试和集成测试
4. **运行质量检查**：使用 `python scripts/quality_gate.py` 检查代码质量
5. **更新文档**：更新相关文档和注释

### 添加新模板

1. **截取图片**：使用游戏内截图功能
2. **处理图片**：调整大小和格式
3. **保存文件**：放置在 `assets/templates/` 目录
4. **测试识别**：验证模板识别效果

### 调试技巧

1. **启用调试模式**：在配置中设置 `debug_mode = true`
2. **查看日志**：检查 `logs/` 目录下的日志文件
3. **使用断点**：在 IDE 中设置断点调试
4. **截图分析**：保存截图分析识别问题

## 注意事项

### ⚠️ 重要提醒

1. **仅供学习**：本项目仅用于学习和研究目的
2. **遵守规则**：使用时请遵守游戏服务条款
3. **风险自负**：使用自动化工具可能存在封号风险
4. **备份数据**：使用前请备份重要的游戏数据

### 🛡️ 安全建议

1. **启用安全模式**：建议始终启用安全模式
2. **适度使用**：避免长时间连续使用
3. **监控状态**：使用时保持监控程序状态
4. **及时停止**：发现异常时立即停止程序

## 故障排除

### 常见问题

**Q: 程序无法启动**
- 检查 Python 版本是否符合要求
- 确认所有依赖包已正确安装
- 查看错误日志获取详细信息

**Q: 无法识别游戏界面**
- 确认游戏分辨率设置正确
- 检查模板图片是否存在
- 调整检测阈值参数

**Q: 自动化操作失败**
- 检查游戏窗口是否处于前台
- 确认操作延迟设置合理
- 查看执行日志了解失败原因

### 获取帮助

1. **查看日志**：首先检查程序日志文件
2. **检查配置**：确认配置文件设置正确
3. **重启程序**：尝试重启程序解决临时问题
4. **重置配置**：删除用户配置文件恢复默认设置

## 更新日志

### v1.0.0 (当前版本)

- ✅ 完整的项目架构和基础功能
- ✅ PyQt6 现代化用户界面
- ✅ OpenCV 图像识别系统
- ✅ SQLite 数据库管理
- ✅ 完善的日志和配置系统
- ✅ 自动化任务管理
- ✅ 安全模式和错误处理

## 许可证

本项目仅供学习和研究使用，不得用于商业目的。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进项目。

---

**免责声明**：本项目仅用于技术学习和研究，使用者需自行承担使用风险。